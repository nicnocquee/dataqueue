---
title: Database Migration
---

After installing the package, add the following script to your `package.json` to apply [the migrations](https://github.com/nicnocquee/dataqueue/tree/main/packages/dataqueue/migrations):

```json
"scripts": {
  "migrate-dataqueue": "dataqueue-cli migrate"
}
```

Next, run this command to apply the migrations:

```package-install
npm run migrate-dataqueue
```

This will apply all the necessary schema migrations so your Postgres database is ready to use with DataQueue.

<Callout type="warn">
  **Make sure the `PG_DATAQUEUE_DATABASE` environment variable is set to your
  Postgres connection string.** The CLI uses this environment variable to
  connect to your database.
</Callout>

### Using a custom .env file

You can use the `--envPath` option to specify a custom path to your environment file. For example:

```package-install
npm run migrate-dataqueue -- --envPath .env.local
```

This will load environment variables from `.env.local` before running the migration.

### Schema detection

If your `PG_DATAQUEUE_DATABASE` connection string contains a `search_path` parameter, the CLI will automatically set the schema for migrations and ensure the schema is created if it does not exist.

**Example Postgres URL with schema:**

```dotenv title=".env.local"
PG_DATAQUEUE_DATABASE=postgres://user:password@localhost:5432/mydb?search_path=my_schema
```

<Callout type="warn">
  **You must run these migrations before using the job queue.** For example, if
  you are deploying your app to Vercel, run this command before deploying in the
  Vercel's pipeline. If you have used Prisma or other ORMs, you may be familiar
  with this process.
</Callout>
